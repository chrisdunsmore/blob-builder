<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Template Engine - Compact + Dark Mode</title>
  <style>
    :root {
      --bg-color: #f9f9f9;
      --text-color: #000;
      --input-bg: #fff;
      --input-border: #ccc;
      --code-bg: #1e1e1e;
      --code-text: #d4d4d4;
      --tag-color: #569CD6;
      --attr-color: #9CDCFE;
      --value-color: #CE9178;
    }

    body.dark {
      --bg-color: #1e1e1e;
      --text-color: #ddd;
      --input-bg: #2d2d2d;
      --input-border: #555;
      --code-bg: #2d2d2d;
      --code-text: #ccc;
      --tag-color: #4FC1FF;
      --attr-color: #9CDCFE;
      --value-color: #D69D85;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s, color 0.3s;
    }

    h2 {
      margin-top: 30px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .replace-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 20px;
    }

    .flex-2 {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .half {
      flex: 1;
    }

    input, textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 6px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-color);
      border-radius: 4px;
      font-family: monospace;
      transition: background 0.3s, color 0.3s, border 0.3s;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    button {
      padding: 10px 15px;
      cursor: pointer;
      font-weight: bold;
      border: none;
      border-radius: 4px;
      background: var(--tag-color);
      color: white;
      transition: background 0.3s;
    }

    .color-themes {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .color-btn {
      border: none;
      padding: 10px 14px;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
      border-radius: 5px;
    }

    pre.code-output {
      background: var(--code-bg);
      color: var(--code-text);
      padding: 15px;
      border-radius: 5px;
      overflow: auto;
      height: 400px;
      font-family: Consolas, monospace;
      transition: background 0.3s, color 0.3s;
    }

    /* Syntax highlight */
    .hl-tag { color: var(--tag-color); }
    .hl-attr { color: var(--attr-color); }
    .hl-value { color: var(--value-color); }
    .hl-text { color: var(--code-text); }

    iframe {
      width: 100%;
      min-height: 400px;
      border: 1px solid var(--input-border);
      background: white;
    }
  </style>
</head>
<body>

  <div class="top-bar">
    <h1>Template Engine</h1>
    <button onclick="toggleDarkMode()">ðŸŒ™ Toggle Dark Mode</button>
  </div>

  <h2>Color Theme Quick Select</h2>
  <div class="color-themes">
    <button class="color-btn" style="background:#328833" onclick="setColors('#328833','#65b766')">Green</button>
    <button class="color-btn" style="background:#5b46c4" onclick="setColors('#5b46c4','#745af5')">Violet</button>
    <button class="color-btn" style="background:#c74200" onclick="setColors('#c74200','#ff8141')">Tawny Orange</button>
    <button class="color-btn" style="background:#cc0100" onclick="setColors('#cc0100','#fe3725')">Red</button>
    <button class="color-btn" style="background:#446775" onclick="setColors('#446775','#527c8e')">Slate Grey</button>
    <button class="color-btn" style="background:#4b6a3c" onclick="setColors('#4b6a3c','#6a7a62')">Old Vine</button>
    <button class="color-btn" style="background:#337d94" onclick="setColors('#337d94','#4b99b1')">Teal Blue</button>
    <button class="color-btn" style="background:#19507f" onclick="setColors('#19507f','#296293')">Mid Blue</button>
    <button class="color-btn" style="background:#3b4caa" onclick="setColors('#3b4caa','#5069e7')">Light Navy</button>
    <button class="color-btn" style="background:#4a0d66" onclick="setColors('#4a0d66','#6e3d85')">Purple</button>
  </div>

  <h2>Part 1: Define Variables</h2>
  <div class="grid">
    <div><label for="var1">var1 (Primary Color)</label><input id="var1" oninput="updateColor(this)"></div>
    <div><label for="var2">var2 (Secondary Color)</label><input id="var2" oninput="updateColor(this)"></div>
    <div><label for="var3">var3</label><input id="var3"></div>
    <div><label for="var4">var4</label><input id="var4"></div>
    <div><label for="var5">var5</label><input id="var5"></div>
    <div><label for="var6">var6</label><input id="var6"></div>
    <div><label for="var7">var7</label><input id="var7"></div>
    <div><label for="var8">var8</label><input id="var8"></div>
    <div><label for="var9">var9</label><input id="var9"></div>
  </div>

  <h2>Optional: Find & Replace</h2>
  <div class="replace-grid">
    <div><label for="find1">Find 1</label><input id="find1"></div>
    <div><label for="replace1">Replace with</label><input id="replace1"></div>
    <div><label for="find2">Find 2</label><input id="find2"></div>
    <div><label for="replace2">Replace with</label><input id="replace2"></div>
    <div><label for="find3">Find 3</label><input id="find3"></div>
    <div><label for="replace3">Replace with</label><input id="replace3"></div>
    <div><label for="find4">Find 4</label><input id="find4"></div>
    <div><label for="replace4">Replace with</label><input id="replace4"></div>
  </div>

  <h2>Part 2: Template and Action</h2>
  <div class="flex-2">
    <div class="half">
      <textarea id="template" placeholder='e.g. <a href="var2" style="color:var1">var3</a>'></textarea>
    </div>
    <div class="half" style="display: flex; align-items: flex-start;">
      <button onclick="applyTemplate()" style="width: 100%;">Generate HTML</button>
    </div>
  </div>

  <h2>Part 3 and Part 4: Output and Live Preview</h2>
  <div class="flex-2">
    <div class="half">
      <button onclick="copyToClipboard()">ðŸ“‹ Copy HTML</button>
      <pre id="highlighted" class="code-output"></pre>
    </div>
    <div class="half">
      <iframe id="preview"></iframe>
    </div>
  </div>

<script>
function toggleDarkMode() {
  document.body.classList.toggle('dark');
}

function setColors(primary, secondary) {
  document.getElementById("var1").value = primary;
  document.getElementById("var2").value = secondary;
  updateColor(document.getElementById("var1"));
  updateColor(document.getElementById("var2"));
}

function updateColor(input) {
  const val = input.value.trim();
  if (/^#[0-9a-f]{6}$/i.test(val)) {
    input.style.backgroundColor = val;
    input.style.color = "#fff";
  } else {
    input.style.backgroundColor = "";
    input.style.color = "";
  }
}

function applyFindReplace(str) {
  for (let i = 1; i <= 4; i++) {
    const find = document.getElementById("find" + i).value;
    const replace = document.getElementById("replace" + i).value;
    if (find) {
      str = str.split(find).join(replace);
    }
  }
  return str;
}

function applyTemplate() {
  let template = document.getElementById("template").value;

  const vars = {};
  for (let i = 1; i <= 9; i++) {
    const raw = document.getElementById("var" + i).value;
    vars["var" + i] = applyFindReplace(raw);
  }

  Object.keys(vars).forEach(key => {
    const regex = new RegExp(key, "g");
    template = template.replace(regex, vars[key]);
  });

  document.getElementById("preview").srcdoc = template;
  document.getElementById("highlighted").innerHTML = highlightHTML(template);
}

function copyToClipboard() {
  const dummy = document.createElement("textarea");
  dummy.value = document.getElementById("highlighted").textContent;
  document.body.appendChild(dummy);
  dummy.select();
  document.execCommand("copy");
  document.body.removeChild(dummy);
  alert("HTML copied to clipboard!");
}

function highlightHTML(html) {
  return html
    .replace(/</g, '&lt;').replace(/>/g, '&gt;')
    .replace(/(&lt;\/?[a-z]+)(.*?)(\/?&gt;)/gi, (_, tag, attrs, close) =>
      `<span class="hl-tag">${tag}</span><span class="hl-attr">${attrs}</span><span class="hl-tag">${close}</span>`
    )
    .replace(/"(.*?)"/g, '<span class="hl-value">"$1"</span>');
}
</script>

</body>
</html>
